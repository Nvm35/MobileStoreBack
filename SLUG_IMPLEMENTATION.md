# Реализация Slug'ов для товаров

## Обзор

Система slug'ов была реализована для замены неудобных UUID в URL'ах товаров на читаемые и SEO-дружественные строки.

## Что изменилось

### 1. Модель Product

- Добавлено поле `Slug` с уникальным индексом
- Поле обязательное и уникальное

### 2. Утилиты для работы со slug'ами

- `utils.GenerateSlug()` - создает slug из названия товара
- `utils.GenerateUniqueSlug()` - создает уникальный slug
- `utils.ValidateSlug()` - проверяет валидность slug
- Поддержка транслитерации кириллицы в латиницу

### 3. Обновленные сервисы

- `ProductService.Create()` - автоматически генерирует slug при создании товара
- `ProductService.GetBySlug()` - получение товара по slug
- `ProductService.GetBySlugOrID()` - универсальный метод поиска по slug или ID

### 4. Обновленные handlers

- `GetProduct()` - теперь поддерживает поиск как по ID, так и по slug

### 5. База данных

- Добавлено поле `slug` в таблицу `products`
- Создан уникальный индекс для поля `slug`
- Обновлены тестовые данные с slug'ами

## Примеры использования

### API Endpoints

```bash
# Получение товара по slug
GET /api/products/apple-airpods-pro-2

# Получение товара по ID (по-прежнему работает)
GET /api/products/123e4567-e89b-12d3-a456-426614174000
```

### Примеры slug'ов

| Название товара                             | Slug                                    |
| ------------------------------------------- | --------------------------------------- |
| Чехол Apple Silicone Case для iPhone 15 Pro | `apple-silicone-case-iphone-15-pro`     |
| Беспроводная зарядка Anker PowerWave 7.5W   | `anker-powervave-7-5w-wireless-charger` |
| Наушники JBL Tune 760NC                     | `jbl-tune-760nc`                        |

## Миграция

Для существующих баз данных создан скрипт миграции:
`migrations/001_add_slug_to_products.sql`

### Выполнение миграции

```sql
-- Запустите скрипт миграции
\i migrations/001_add_slug_to_products.sql
```

## Особенности реализации

### 1. Транслитерация

- Кириллические символы автоматически транслитерируются в латиницу
- Поддержка всех основных русских букв

### 2. Уникальность

- При создании товара автоматически проверяется уникальность slug
- При конфликте добавляется числовой суффикс (например: `product-1`, `product-2`)

### 3. Валидация

- Slug должен содержать только латинские буквы, цифры и дефисы
- Длина от 3 до 100 символов
- Не может начинаться или заканчиваться дефисом

### 4. Обратная совместимость

- API поддерживает поиск как по slug, так и по UUID
- Существующие ссылки с UUID продолжают работать

## Преимущества

1. **SEO-дружественность** - читаемые URL'ы улучшают поисковую оптимизацию
2. **Удобство для пользователей** - понятные ссылки легче запоминать и делиться
3. **Читаемость** - slug'и содержат информацию о товаре
4. **Обратная совместимость** - старые ссылки продолжают работать

## Тестирование

Для тестирования новой функциональности:

```bash
# Создание товара (slug генерируется автоматически)
POST /api/products
{
  "name": "Новый товар",
  "price": 1000,
  "sku": "TEST-001",
  "category_id": "uuid-here"
}

# Получение по slug
GET /api/products/novyy-tovar

# Получение по ID (по-прежнему работает)
GET /api/products/uuid-here
```
